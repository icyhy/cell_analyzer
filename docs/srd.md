# 软件需求文档 (SRD): 交互式细胞图像分析平台

---

## 1. 引言

### 1.1 目的
本文档旨在明确定义“交互式细胞图像分析平台”的功能与非功能性需求。它将作为产品设计、开发、测试和未来迭代的统一依据，确保所有相关方对项目范围和目标有共同的理解。

### 1.2 项目范围
本项目将开发一个基于Web的应用程序，专注于处理和分析`.tif`格式的双光子荧光细胞/神经元图像。核心功能包括：图像上传与管理、多帧图像（Stack）的交互式浏览、基于Cellpose的自动化细胞识别、用户自定义的感兴趣区域（ROI）分析以及结果数据的导出。项目初期将集中于核心功能的实现，确保为生物研究人员提供一个高效、精准且易于使用的分析工具。

### 1.3 术语表
- **GUI**: 图形用户界面 (Graphical User Interface)
- **TIF/TIFF**: 标签图像文件格式 (Tagged Image File Format)，一种常用于存储高质量图像的文件格式。
- **Stack**: Z-Stack，指在不同Z轴平面上采集的一系列图像，组合成一个多层图像文件。
- **Cellpose**: 一个基于深度学习的、用于细胞分割的开源算法。
- **ROI**: 感兴趣区域 (Region of Interest)，用户在图像上为进行局部化分析而手动划定的区域。
- **细胞密度**: 单位面积内的细胞数量。

---

## 2. 总体描述

### 2.1 产品愿景
我们的愿景是打造一个领先的在线平台，使全球的生物科学家能够从复杂的细胞图像中轻松提取定量数据，从而加速科学发现的进程。我们致力于通过直观的设计和强大的自动化功能，消除图像分析的技术壁垒。

### 2.2 用户特征
目标用户主要为从事生命科学研究的专业人士，他们具备深厚的生物学背景，但可能缺乏专业的编程或图像处理技能。他们追求高效、准确的数据，并需要将分析结果用于学术报告和论文发表。

### 2.3 假设与依赖
- **假设**: 用户具备基本的计算机操作能力，并能通过主流的现代Web浏览器访问本应用。
- **依赖**: 应用的核心细胞识别功能将依赖于`Cellpose`算法库。因此，后端环境需要能够支持并成功集成该Python库。

---

## 3. 系统特性与需求

### 3.1 功能性需求

#### 3.1.1 文件上传与管理
- **REQ-001**: 系统必须允许用户通过拖拽或文件选择对话框上传一个或多个`.tif`/`.tiff`格式的图像文件。
- **REQ-002**: 系统必须在文件上传过程中显示一个明确的进度指示器。
- **REQ-003**: 若用户上传了不支持的文件格式，系统必须显示友好且清晰的错误提示。
- **REQ-004**: 所有成功上传的图像文件应以列表或缩略图的形式展示在文件管理区。
- **REQ-005**: 文件列表中必须显示每个文件的基本信息，至少包括文件名和上传日期。
- **REQ-006**: 用户必须能够从文件列表中选择一个文件进行分析，或将其从系统中删除。

#### 3.1.2 图像查看与导航
- **REQ-007**: 系统必须在主视图区域高保真地渲染用户选择的`.tif`图像。
- **REQ-008**: 用户必须能够使用鼠标或触控板对图像进行缩放和平移操作。
- **REQ-009**: 系统必须能自动检测图像是否为多帧Stack。若是，则必须提供一个滑动条控件。
- **REQ-010**: 用户通过拖动Stack滑动条，可以逐帧浏览图像，且系统应实时显示当前帧的索引号。

#### 3.1.3 自动化细胞识别
- **REQ-011**: 系统必须提供一个明确的“开始分析”按钮，以启动后端细胞识别流程。
- **REQ-012**: 在分析过程中，界面必须显示一个加载状态指示器（如Spinner或进度条）。
- **REQ-013**: 分析完成后，系统必须在图像上以半透明轮廓的形式叠加显示所有被识别出的细胞。
- **REQ-014**: 叠加的轮廓不得完全遮挡原始图像的像素信息。
- **REQ-015**: 系统必须在分析结果区实时显示识别出的细胞总数。

#### 3.1.4 感兴趣区域 (ROI) 分析
- **REQ-016**: 系统必须提供至少三种ROI绘制工具：圆形、矩形和多边形。
- **REQ-017**: 用户必须能够在图像上绘制一个或多个ROI。
- **REQ-018**: 用户必须能够编辑（移动、调整大小）或删除已绘制的ROI。
- **REQ-019**: 每当一个ROI被创建或修改后，系统必须自动计算并显示以下数据：
  - a. ROI内的细胞数量。
  - b. ROI的面积（以像素²为单位）。
  - c. ROI内的细胞密度（细胞数/像素²）。
- **REQ-020**: 系统必须能同时管理多个ROI，并分别展示它们的分析数据。

#### 3.1.5 数据导出
- **REQ-021**: 用户必须能够将分析的统计数据（如细胞总数、各ROI的详细数据）导出为`.csv`文件。
- **REQ-022**: 用户必须能够将当前显示的带有分析标记（细胞轮廓、ROI）的图像视图导出为`.png`文件。

### 3.2 非功能性需求

#### 3.2.1 性能
- **NFR-001**: 图像上传和渲染时间：对于一个50MB的`.tif`文件，在标准网络环境下，从上传完成到在界面上可操作的时间应少于5秒。
- **NFR-002**: 细胞识别处理时间：对于一张包含约500个细胞的2D图像，服务器端的分析时间应不超过30秒。
- **NFR-003**: 界面响应：所有的UI交互（如缩放、平移、拖动滑动条）必须流畅，无明显卡顿。

#### 3.2.2 易用性
- **NFR-004**: 界面必须遵循“三栏式”布局，逻辑清晰，符合用户预期。
- **NFR-005**: 所有交互控件（按钮、滑动条、工具）必须有清晰的图标或文字标签。
- **NFR-006**: 系统应为首次使用的用户提供一个简短的引导（Tutorial）或在关键功能点提供提示信息（Tooltips）。

#### 3.2.3 可靠性
- **NFR-007**: 系统应能稳定运行，7x24小时可用性不低于99.5%。
- **NFR-008**: 后端分析任务的失败不应导致前端应用崩溃。系统应能优雅地处理错误，并向用户显示有意义的错误信息。

#### 3.2.4 兼容性
- **NFR-009**: Web应用必须在最新版本的Google Chrome、Mozilla Firefox和Microsoft Edge浏览器上功能完备且显示正常。

---

## 4. 附录

### 4.1 低保真线框图
*详见 `wireframes.md` 文件。*